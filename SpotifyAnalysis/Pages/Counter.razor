@page "/counter"

@using SpotifyAnalysis.Data
@using SpotifyAPI.Web
@using ChartJs.Blazor.Util

@inject Spotify spotify;

<p>
	<label for="userId">User ID:</label>
	<input id="userId" size="30" @bind="userID" />
	<button class="btn-primary" @onclick="GetPlaylists">Get playlists</button>
</p>

@if (playlists != null) {
	<PlaylistList Playlists="playlists"></PlaylistList>
}

<PieChart Title="sample" Elements="elements" />

@code {
	private string? userID = "11ek5k7fhea9otrb7k2ecizzb";
	private IEnumerable<SimplePlaylist> playlists;


	Elements elements = new Elements {
			new Element{ Label = "Red", Quantity = 6 },
			new Element{ Label = "Yellow", Quantity = 5 },
			new Element{ Label = "Green", Quantity = 3 },
			new Element{ Label = "Blue", Quantity = 7 }
		};

	public async void GetPlaylists() {
		//var profile = await spotify.SpotifyClient.UserProfile.Get(user);
		var playlistsTask = spotify.SpotifyClient.Playlists.GetUsers(userID);
		playlistsTask.Wait();
		var playlistsAll = spotify.SpotifyClient.PaginateAll(playlistsTask.Result);
		playlistsAll.Wait();
		playlists = playlistsAll.Result;
	}
}